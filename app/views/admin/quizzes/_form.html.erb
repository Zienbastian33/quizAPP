<%# Formulario compartido para new y edit %>
<%= form_with(model: [:admin, quiz], class: "space-y-6") do |f| %>

  <%# ══ Errores de validación ══ %>
  <% if quiz.errors.any? %>
    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
      <h3 class="text-red-800 font-semibold mb-2">
        Se encontraron <%= quiz.errors.count %> error(es):
      </h3>
      <ul class="list-disc pl-5 text-red-700 text-sm space-y-1">
        <% quiz.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%# ══ Título ══ %>
  <div>
    <%= f.label :title, "Título del Quiz", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= f.text_field :title, placeholder: "Ej: Capitales del Mundo",
        class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition" %>
  </div>

  <%# ══ Descripción ══ %>
  <div>
    <%= f.label :description, "Descripción", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <%= f.text_area :description, rows: 4,
        placeholder: "Describe brevemente de qué trata este quiz...",
        class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition resize-y" %>
  </div>

  <%# ══ Imagen de portada (Active Storage) ══ %>
  <div>
    <%= f.label :cover_image, "Imagen de portada (opcional)", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <% if quiz.cover_image.attached? %>
      <div class="mb-2">
        <%= image_tag quiz.cover_image, class: "h-32 rounded-lg object-cover" %>
      </div>
    <% end %>
    <%= f.file_field :cover_image, accept: "image/*",
        class: "w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100" %>
  </div>

  <%# ══ Video o media (Active Storage) ══ %>
  <div>
    <%= f.label :media, "Video o archivo multimedia (opcional)", class: "block text-sm font-medium text-gray-700 mb-1" %>
    <% if quiz.media.attached? %>
      <div class="mb-2">
        <span class="text-sm text-green-600">✓ Archivo adjunto: <%= quiz.media.filename %></span>
      </div>
    <% end %>
    <%= f.file_field :media, accept: "video/*,audio/*",
        class: "w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100" %>
  </div>

  <%# ══ Botones ══ %>
  <div class="flex gap-3 pt-2">
    <%= f.submit(quiz.persisted? ? "Actualizar Quiz" : "Crear Quiz",
        class: "bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 focus:ring-4 focus:ring-indigo-200 transition cursor-pointer") %>
    <%= link_to "Cancelar",
        (quiz.persisted? ? admin_quiz_path(quiz) : admin_quizzes_path),
        class: "bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-medium hover:bg-gray-200 transition" %>
  </div>
<% end %>
